# تعليمات إصلاح جدول ratings

## المشكلة
جدول `ratings` في قاعدة البيانات لا يحتوي على جميع الأعمدة المطلوبة لحفظ التقييمات.

## الحل
يجب تطبيق ملف SQL التالي لإضافة الأعمدة المطلوبة:

### الطريقة 1: استخدام Supabase Dashboard
1. افتح Supabase Dashboard
2. اذهب إلى SQL Editor
3. انسخ محتوى ملف `add_ratings_columns.sql`
4. الصق المحتوى في SQL Editor
5. اضغط على "Run" لتطبيق التغييرات

### الطريقة 2: استخدام Supabase CLI
```bash
supabase db push
```

## الأعمدة التي سيتم إضافتها:
- `rating` (INTEGER): قيمة التقييم من 1 إلى 5
- `comment` (TEXT): تعليق المستخدم (اختياري)
- `product_id` (UUID): معرف المنتج (إذا كان التقييم لمنتج)
- `created_at` (TIMESTAMP): تاريخ الإنشاء
- `updated_at` (TIMESTAMP): تاريخ التحديث

## ملاحظات:
- الملف يستخدم `DO $$` blocks للتأكد من عدم إضافة الأعمدة إذا كانت موجودة بالفعل
- سيتم إضافة indexes لتحسين الأداء
- سيتم إضافة constraint للتأكد من أن التقييم يحتوي على `restaurant_id` أو `product_id` فقط

## بعد تطبيق التغييرات:
1. تأكد من أن RLS policies تسمح بإدراج التقييمات
2. اختبر إضافة تقييم جديد للمطعم أو المنتج
3. تأكد من أن التقييمات تظهر في قسم التقييمات

